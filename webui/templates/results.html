<!doctype html>
<html>
  <head>
    <link rel="stylesheet" href="{{url_for('static', filename='sample.css') }}">
  </head>
  <body>
    <h1>Map</h1>

    <div id="map">
      <img id="map_background">
      <svg id="map_bboxes">
    </div>

    <h1>Uploaded image</h1>
    <div id="upload">
      <img id="uploaded_image">
    </div>

    <h1>Bounding boxes</h1>
    <div id='bboxes'>{{bboxes}}</div>

    <h1>Probabilities</h1>
    <div id='probs'>{{probs}}</div>

    <script>
      var image = "{{image|safe}}";
      var bboxes = {{bboxes|safe}};
      var probs = {{probs|safe}};
      const svgns = 'http://www.w3.org/2000/svg';

      // Place the original image in the DOM, in two places
      document.querySelector('img#map_background').setAttribute(
          'src', 'data:image/jpg;base64, ' + image
      );

      document.querySelector('img#uploaded_image').setAttribute(
          'src', 'data:image/jpg;base64, ' + image
      );

      // Place the bounding boxes into an existing SVG element.
      container = document.querySelector('#map');
      s = document.querySelector('svg#map_bboxes');
      s.setAttributeNS(null, 'width', {{width}});
      s.setAttributeNS(null, 'height', {{height}});

      rects = bboxes['bg'].map(bb => {
          e = document.createElementNS(svgns, 'rect');
          e.setAttributeNS(null, 'x', bb[0]);
          e.setAttributeNS(null, 'y', bb[1]);
          e.setAttributeNS(null, 'width', bb[2]);
          e.setAttributeNS(null, 'height', bb[3]);
          return e;
      });

      rects.forEach(rect => s.appendChild(rect));
    </script>
  </body>
</html>
